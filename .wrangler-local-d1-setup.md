# Local D1 Development Setup

When running `wrangler dev` locally, D1 automatically creates a local SQLite database in:
```
.wrangler/state/v3/d1/
```

## First Time Setup

The first time you run `wrangler dev`, the local D1 database will be created but **empty**. You need to initialize the schema:

```bash
# Option 1: Use wrangler to execute on local D1
wrangler d1 execute catchess-db --local --file=./schema.sql

# Option 2: Or just start dev and it will create tables automatically
wrangler dev
```

## Verify Local Database

```bash
# List all tables
wrangler d1 execute catchess-db --local --command="SELECT name FROM sqlite_master WHERE type='table'"

# Check rooms
wrangler d1 execute catchess-db --local --command="SELECT * FROM chess_rooms"
```

## Reset Local Database

If you need to reset your local D1 database:

```bash
# Delete the local database
rm -rf .wrangler/state/v3/d1/

# Restart wrangler dev and reinitialize
wrangler dev
```

## Production vs Local

- **Local** (`wrangler dev`): Uses `.wrangler/state/v3/d1/` SQLite file
- **Production** (`wrangler deploy`): Uses actual Cloudflare D1 database

Make sure you run the schema initialization on both:
```bash
# Local
wrangler d1 execute catchess-db --local --file=./schema.sql

# Production (after creating DB)
wrangler d1 execute catchess-db --file=./schema.sql
```
